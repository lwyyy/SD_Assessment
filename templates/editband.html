<!DOCTYPE html>
<html>
<head>
    <title>Ship Crew Editor</title>
    <style type="text/css">
        #dist {
            margin-left: 40px;
        }

        ul {
            list-style-type: none;
            width: 100%;
            margin-top: 30px;
            padding: 0;
            overflow: hidden;
            background-color: #4a86e8;
        }

        li {
            float: left;
        }

        a:link, a:visited {
            display: block;
            width: auto;
            font-weight: bold;
            color: #FFFFFF;
            background-color: #4a86e8;
            font-size: 16px;
            text-align: center;
            padding: 15px;
            margin-left: 40px;
            text-decoration: none;
            text-transform: uppercase;
        }

        a:hover, a:active {
            background-color: #1c4587;
        }

        i {
            font-size: 12px;
            color: #000000;
        }

        table, th, td {
            border: 1px solid black;
            text-align: left;
        }
    </style>
    <script type="text/javascript">
        var total = {{ band['Treasury'] }};
        var capweapcost = 0;
        var engweapcost = 0;
        var mbcost = 0;
        var member_num = {{ band['mbNumber'] }};
        var checkname = true;
        var refund_list = [];
        var exp_flag = 0;
        var cap_exp = 0;
        var ens_exp = 0;
        var specens_flag = 0;

        {% if 'Ensign' in band.keys() %}
            var engHire = true;
            var hadEnsign = true;
            var fireflag = false;
            specens_flag = 1;
        {%else%}
            var engHire = false;
            var hadEnsign = false;
            var fireflag = true;
        {% endif %}

        for (var i = 0; i < 10; i++) {
            if (i <= {{ band['Troops']|length }}) {
                refund_list[i] = true;
            } else {
                refund_list[i] = false;
            }
        }

        function hireEng() {
            if (engHire == false) {
                engHire = true;
                specens_flag = 0;
                document.getElementById("ensignHireDiv").style.display = "block";
                total = total - 250;
                member_num = member_num + 1;
                members.innerHTML = member_num;
                check_Members();
                remainingGold.innerHTML = total;
                check_Currency();
            }
            else {
                engHire = false;
                specens_flag = 1;
                document.getElementById("ensignHireDiv").style.display = "none";
                document.getElementById("ensweapsel").value = "Empty";
                document.getElementById("ensskillsel").value = "Empty";
                setEnsSkillchoice("Empty");
                if (fireflag == true) {
                    total = total + 250 + engweapcost;
                    engweapcost = 0;
                }

                {% if 'Ensign' in band.keys() %}
                    fireflag = true;
                    document.getElementById("ensignDiv").style.display = "none";
                {% endif %}

                member_num = member_num - 1;
                members.innerHTML = member_num;
                check_Members();
                remainingGold.innerHTML = total;
                check_Currency();
            }
        }

        function check_Bandname(bandname) {
            if (isNaN(bandname)) {
                {% for name in bands %}
                    if (bandname == "{{ name }}" && bandname != "{{ band['Name'] }}") {
                        checkname = false;
                        document.getElementById("check_name").innerHTML = "Bandname not available!";
                        return false;
                    }
                {% endfor %}
                checkname = true;
                document.getElementById("check_name").innerHTML = "Bandname available";
            } else {
                checkname = false;
                document.getElementById("check_name").innerHTML = "Bandname cannot be empty!";
            }
        }

        function check_Members() {
            if (member_num > 10) {
                document.getElementById("checkmembers").innerHTML = "Exceed 10 members!";
            } else {
                document.getElementById("checkmembers").innerHTML = "Regular Members";
            }
        }

        function check_Currency() {
            if (total < 0) {
                document.getElementById("checkcurrency").innerHTML = "Lower than 0 gc!";
            } else {
                document.getElementById("checkcurrency").innerHTML = "Regular Currency";
            }
        }

        function updateTableRow(fake_row, x) {
            var sel = x.value;
            var row = fake_row + 1;

            var myTable = document.getElementById('rosterTable');

            if (sel == "Empty") {
                member_num = member_num - 1;
                members.innerHTML = member_num;
                check_Members();
                if (refund_list[fake_row - 1] == false) {
                    mbcost = parseInt(myTable.rows[row].cells[7].innerHTML);
                    total = total + mbcost;
                    mbcost = 0;
                }
                myTable.rows[row].cells[1].innerHTML = '-';
                myTable.rows[row].cells[2].innerHTML = '-';
                myTable.rows[row].cells[3].innerHTML = '-';
                myTable.rows[row].cells[4].innerHTML = '-';
                myTable.rows[row].cells[5].innerHTML = '-';
                myTable.rows[row].cells[6].innerHTML = '-';
                myTable.rows[row].cells[7].innerHTML = 0;
                myTable.rows[row].cells[8].innerHTML = '-';
            } else {
                if (refund_list[fake_row - 1] == false && myTable.rows[row].cells[7].innerHTML != 0) {
                    mbcost = parseInt(myTable.rows[row].cells[7].innerHTML);
                    total = total + mbcost;
                }

                if (myTable.rows[row].cells[7].innerHTML == 0) {
                    member_num = member_num + 1;
                    members.innerHTML = member_num;
                    check_Members();
                }

                {% for troop in people.keys() %}
                    if (sel == "{{troop}}") {
                        myTable.rows[row].cells[1].innerHTML = '{{ people[troop]['Move'] }}';
                        myTable.rows[row].cells[2].innerHTML = '{{ people[troop]['Fight'] }}';
                        myTable.rows[row].cells[3].innerHTML = '{{ people[troop]['Shoot'] }}';
                        myTable.rows[row].cells[4].innerHTML = '{{ people[troop]['Shield'] }}';
                        myTable.rows[row].cells[5].innerHTML = '{{ people[troop]['Morale'] }}';
                        myTable.rows[row].cells[6].innerHTML = '{{ people[troop]['Health'] }}';
                        myTable.rows[row].cells[7].innerHTML = '{{ people[troop]['Cost'] }}';
                        myTable.rows[row].cells[8].innerHTML = '{{ people[troop]['Notes'] }}';
                    }
                {% endfor %}

                mbcost = parseInt(myTable.rows[row].cells[7].innerHTML);
                total = total - mbcost;
                mbcost = 0;
                refund_list[fake_row - 1] = false;
            }
            remainingGold.innerHTML = total;
            check_Currency();
        }

        // add experience points of captain
        function addCapExp() {
            var exp = parseInt(document.getElementById("capexp_num").value);
            var old_exp = parseInt(document.getElementById("capexp").innerHTML);

            if (exp < 0) {
                document.getElementById("capexp_num").value = 0;
                alert("Exp number cannot less than zero!")
            } else {
                cap_exp = cap_exp + exp;
                capexp.innerHTML = (old_exp + exp);
                document.getElementById("capexp_num").value = 0;
            }
        }

        // add experience points of captain
        function addEnsExp() {
            var exp = parseInt(document.getElementById("enexp_num").value);
            var old_exp = parseInt(document.getElementById("enexp").innerHTML);

            if (exp < 0) {
                document.getElementById("enexp_num").value = 0;
                alert("Exp number cannot less than zero!")
            } else {
                ens_exp = ens_exp + exp;
                enexp.innerHTML = (old_exp + exp);
                document.getElementById("enexp_num").value = 0;
            }
        }

        // add money to squad bank
        function topUp() {
            var credits = parseInt(document.getElementById("topup_num").value);

            if (credits < 0) {
                alert("Top up number can not lower than zero!")
            } else {
                total = total + credits;
                remainingGold.innerHTML = total;
                document.getElementById("topup_num").value = 0;
                check_Currency();
            }
        }

        // update the weapon cost of Captain
        function updateCapWeapCost(x) {
            var sel = x.value;

            if (sel == "Empty") {
                total = total + capweapcost;
                capweapcost = 0;
            } else {
                total = total + capweapcost;
                {% for weap in costs.keys() %}
                    if (sel == "{{weap}}") {
                        capweapcost = {{ costs[weap] }};
                    }
                {% endfor %}
                total = total - capweapcost;
            }
            remainingGold.innerHTML = total;
            check_Currency();
        }

        // update the weapon cost of Apprentice
        function updateEngWeapCost(x) {
            var sel = x.value;

            if (sel == "Empty") {
                total = total + engweapcost;
                engweapcost = 0;
            } else {
                total = total + engweapcost;
                {% for weap in costs.keys() %}
                    if (sel == "{{weap}}") {
                        engweapcost = {{ costs[weap] }};
                    }
                {% endfor %}
                total = total - engweapcost;
            }
            remainingGold.innerHTML = total;
            check_Currency();
        }

        function setEnsSkillchoice(x) {
            var choice = x.value;
            var myTable = document.getElementById('ensignHireTable');
            var list = myTable.rows[2].cells[8];
            while (list.hasChildNodes()) {
                list.removeChild(list.firstChild);
            }
            if (choice == "Empty") {
                list.appendChild(document.createTextNode("No Skills"));
                specens_flag = 0;
            }
            {% for spec in skills.keys() %}
                if (choice == "{{spec}}") {
                    specens_flag = 1;
                    var div = document.createElement("div");
                    {% for element in skills[spec] %}
                        var tempbutton = document.createElement("input");
                        tempbutton.setAttribute("type", "radio");
                        tempbutton.setAttribute("name", "skillchoiceens");
                        tempbutton.setAttribute("value", "{{element}}");
                        var templabel = document.createElement("label");
                        templabel.appendChild(document.createTextNode("{{element}}"));
                        div.appendChild(tempbutton);
                        div.appendChild(templabel);
                    {% endfor %}
                    list.appendChild(div);
                }
            {% endfor %}
        }

        // judge the stats value of Captain whether exceed the maximum value
        function check_capstats() {
            var fight = document.getElementById("capfig").value;
            var shoot = document.getElementById("capsho").value;
            var morale = document.getElementById("capmor").value;
            var health = document.getElementById("caphea").value;

            if (fight < 11 && shoot < 11 && morale < 13 && health < 21) {
                return true;
            }
            return false;
        }

        // judge the stats value of Apprentice whether exceed the maximum value
        function check_ensstats() {
            var fight = document.getElementById("ensfig").value;
            var shoot = document.getElementById("enssho").value;
            var morale = document.getElementById("ensmor").value;
            var health = document.getElementById("enshea").value;

            if (fight < 7 && shoot < 6 && morale < 7 && health < 17) {
                return true;
            }
            return false;
        }

        /*
            Captain gain a new skill or add a stats value by one
            if users add more than 9 experience points to Captain
         */
        function editCap(origin_id, old_value) {
            if (cap_exp > 9) {
                if (exp_flag == 0) {
                    if (isNaN(old_value)) {
                        exp_flag = 1;
                        var capskillarr = document.getElementsByName(origin_id);
                        for (var k = 0; k < capskillarr.length; k++) {
                            if (capskillarr[k].value == old_value) {
                                capskillarr[k].checked = true;
                                capskillarr[k].disabled = "disabled";
                            }
                        }
                        alert("Edit Captain success");
                    } else {
                        var add_value = parseInt(document.getElementById(origin_id).value);
                        if ((add_value - 1) == old_value) {
                            if (check_capstats()) {
                                exp_flag = 1;
                                alert("Edit Captain success");
                            } else {
                                document.getElementById(origin_id).value = old_value;
                                alert("Greater than maximum!")
                            }
                        } else {
                            document.getElementById(origin_id).value = old_value;
                            alert("Only can add 1!")
                        }
                    }
                } else {
                    if (isNaN(old_value)) {
                        var capskillarr = document.getElementsByName(origin_id);
                        for (var k = 0; k < capskillarr.length; k++) {
                            if (capskillarr[k].value == old_value) {
                                capskillarr[k].checked = false;
                            }
                        }
                        alert("Already edit stats or skills!");
                    } else {
                        document.getElementById(origin_id).value = old_value;
                        alert("Already edit stats or skills!");
                    }
                }
            } else {
                if (isNaN(old_value)) {
                    var capskillarr = document.getElementsByName(origin_id);
                    for (var k = 0; k < capskillarr.length; k++) {
                        if (capskillarr[k].value == old_value) {
                            capskillarr[k].checked = false;
                        }
                    }
                } else {
                    document.getElementById(origin_id).value = old_value;
                }
                alert("New Experience less than 10!")
            }
        }

        /*
            Apprentice gain a new skill or add a stats value by one
            if users add more than 9 experience points to Apprentice
         */
        function editEns(origin_id, old_value) {
            if (ens_exp > 9) {
                if (exp_flag == 0) {
                    if (isNaN(old_value)) {
                        exp_flag = 1;
                        var enskillarr = document.getElementsByName(origin_id);
                        for (var k = 0; k < enskillarr.length; k++) {
                            if (enskillarr[k].value == old_value) {
                                enskillarr[k].checked = true;
                                enskillarr[k].disabled = true;
                            }
                        }
                        alert("Edit Ensign success");
                    } else {
                        var add_value = parseInt(document.getElementById(origin_id).value);
                        if ((add_value - 1) == old_value) {
                            if (check_ensstats()) {
                                exp_flag = 1;
                                alert("Edit Ensign success");
                            } else {
                                document.getElementById(origin_id).value = old_value;
                                alert("Greater than maximum!")
                            }
                        } else {
                            document.getElementById(origin_id).value = old_value;
                            alert("Only can add 1!")
                        }
                    }
                } else {
                    if (isNaN(old_value)) {
                        var enskillarr = document.getElementsByName(origin_id);
                        for (var k = 0; k < enskillarr.length; k++) {
                            if (enskillarr[k].value == old_value) {
                                enskillarr[k].checked = false;
                            }
                        }
                        alert("Already edit stats or skills!");
                    } else {
                        document.getElementById(origin_id).value = old_value;
                        alert("Already edit stats or skills!");
                    }
                }
            } else {
                if (isNaN(old_value)) {
                    var enskillarr = document.getElementsByName(origin_id);
                    for (var k = 0; k < enskillarr.length; k++) {
                        if (enskillarr[k].value == old_value) {
                            enskillarr[k].checked = false;
                        }
                    }
                } else {
                    document.getElementById(origin_id).value = old_value;
                }
                alert("New Experience less than 10!")
            }
        }

        function doFormSubmit() {
            if (member_num < 11 && checkname == true && total >= 0 && specens_flag == 1) {
                method = "post"; // Set method to post by default if not specified.

                var form = document.createElement("form");
                form.setAttribute("method", method);
                form.setAttribute("action", "/edit/{{ band['Name'] }}");

                var bandname = document.createElement("input");
                bandname.setAttribute("type", "hidden");
                bandname.setAttribute("name", "bandname");
                bandname.setAttribute("value", document.getElementById('bandnametext').value);
                form.appendChild(bandname);
                var isPublic = document.createElement("input");
                isPublic.setAttribute("type", "hidden");
                isPublic.setAttribute("name", "isPublic");
                isPublic.setAttribute("value", document.getElementById('isPublic').value);
                form.appendChild(isPublic);
                var mbNumber = document.createElement("input");
                mbNumber.setAttribute("type", "hidden");
                mbNumber.setAttribute("name", "mbNumber");
                mbNumber.setAttribute("value", member_num);
                form.appendChild(mbNumber);
                var treasury = document.createElement("input");
                treasury.setAttribute("type", "hidden");
                treasury.setAttribute("name", "treasury");
                treasury.setAttribute("value", total);
                form.appendChild(treasury);
                var capspec = document.createElement("input");
                capspec.setAttribute("type", "hidden");
                capspec.setAttribute("name", "capspec");
                capspec.setAttribute("value", "{{ band['Captain']['Specialism'] }}");
                form.appendChild(capspec);
                //start
                var capmove = document.createElement("input");
                capmove.setAttribute("type", "hidden");
                capmove.setAttribute("name", "capmove");
                capmove.setAttribute("value", {{ band['Captain']['Move'] }});
                form.appendChild(capmove);
                var capfight = document.createElement("input");
                capfight.setAttribute("type", "hidden");
                capfight.setAttribute("name", "capfight");
                capfight.setAttribute("value", document.getElementById('capfig').value);
                form.appendChild(capfight);
                var capshoot = document.createElement("input");
                capshoot.setAttribute("type", "hidden");
                capshoot.setAttribute("name", "capshoot");
                capshoot.setAttribute("value", document.getElementById('capsho').value);
                form.appendChild(capshoot);
                var capshield = document.createElement("input");
                capshield.setAttribute("type", "hidden");
                capshield.setAttribute("name", "capshield");
                capshield.setAttribute("value", {{ band['Captain']['Shield'] }});
                form.appendChild(capshield);
                var capmorale = document.createElement("input");
                capmorale.setAttribute("type", "hidden");
                capmorale.setAttribute("name", "capmorale");
                capmorale.setAttribute("value", document.getElementById('capmor').value);
                form.appendChild(capmorale);
                var caphealth = document.createElement("input");
                caphealth.setAttribute("type", "hidden");
                caphealth.setAttribute("name", "caphealth");
                caphealth.setAttribute("value", document.getElementById('caphea').value);
                form.appendChild(caphealth);
                var capexperience = document.createElement("input");
                capexperience.setAttribute("type", "hidden");
                capexperience.setAttribute("name", "capexperience");
                capexperience.setAttribute("value", document.getElementById('capexp').innerHTML);
                form.appendChild(capexperience);
                //end
                var capskills = [];
                var capskillarr = document.getElementsByName("capskil");
                for (k = 0; k < capskillarr.length; k++) {
                    if (capskillarr[k].checked) {
                        capskills.push(capskillarr[k].value);
                    }
                }
                var capskill = document.createElement("input");
                capskill.setAttribute("type", "hidden");
                capskill.setAttribute("name", "capskill");
                capskill.setAttribute("value", JSON.stringify(capskills));
                form.appendChild(capskill);
                var capweap1 = document.createElement("input");
                capweap1.setAttribute("type", "hidden");
                capweap1.setAttribute("name", "capweap1");
                capweap1.setAttribute("value", document.getElementById('capweapsel1').value);
                form.appendChild(capweap1);
                var capweap2 = document.createElement("input");
                capweap2.setAttribute("type", "hidden");
                capweap2.setAttribute("name", "capweap2");
                capweap2.setAttribute("value", document.getElementById('capweapsel2').value);
                form.appendChild(capweap2);

                // if hire apprentice
                if (engHire == true) {
                    var hasensign = document.createElement("input");
                    hasensign.setAttribute("type", "hidden");
                    hasensign.setAttribute("name", "hasensign");
                    hasensign.setAttribute("value", engHire);
                    form.appendChild(hasensign);

                    var enmove = document.createElement("input");
                    enmove.setAttribute("type", "hidden");
                    enmove.setAttribute("name", "ensmove");
                    enmove.setAttribute("value", {{ apprentice['Ensign']['Move'] }});
                    form.appendChild(enmove);
                    var enshield = document.createElement("input");
                    enshield.setAttribute("type", "hidden");
                    enshield.setAttribute("name", "ensshield");
                    enshield.setAttribute("value", {{ apprentice['Ensign']['Shield'] }});
                    form.appendChild(enshield);

                    // if had ensign before edit and don't fire it when editing
                    if (hadEnsign == true && fireflag == false) {
                        var fireensign = document.createElement("input");
                        fireensign.setAttribute("type", "hidden");
                        fireensign.setAttribute("name", "fireensign");
                        fireensign.setAttribute("value", fireflag);
                        form.appendChild(fireensign);
                        var enfight = document.createElement("input");
                        enfight.setAttribute("type", "hidden");
                        enfight.setAttribute("name", "ensfight");
                        enfight.setAttribute("value", document.getElementById('enfig').value);
                        form.appendChild(enfight);
                        var enshoot = document.createElement("input");
                        enshoot.setAttribute("type", "hidden");
                        enshoot.setAttribute("name", "ensshoot");
                        enshoot.setAttribute("value", document.getElementById('ensho').value);
                        form.appendChild(enshoot);
                        var enmorale = document.createElement("input");
                        enmorale.setAttribute("type", "hidden");
                        enmorale.setAttribute("name", "ensmorale");
                        enmorale.setAttribute("value", document.getElementById('enmor').value);
                        form.appendChild(enmorale);
                        var enhealth = document.createElement("input");
                        enhealth.setAttribute("type", "hidden");
                        enhealth.setAttribute("name", "enshealth");
                        enhealth.setAttribute("value", document.getElementById('enhea').value);
                        form.appendChild(enhealth);
                        var enexperience = document.createElement("input");
                        enexperience.setAttribute("type", "hidden");
                        enexperience.setAttribute("name", "ensexperience");
                        enexperience.setAttribute("value", document.getElementById('enexp').innerHTML);
                        form.appendChild(enexperience);
                        var ensskills = [];
                        var ensskillarr = document.getElementsByName("ensskil");
                        for (k = 0; k < ensskillarr.length; k++) {
                            if (ensskillarr[k].checked) {
                                ensskills.push(ensskillarr[k].value);
                            }
                        }
                        var ensskill = document.createElement("input");
                        ensskill.setAttribute("type", "hidden");
                        ensskill.setAttribute("name", "ensskill");
                        ensskill.setAttribute("value", JSON.stringify(ensskills));
                        form.appendChild(ensskill);
                        var ensweap = document.createElement("input");
                        ensweap.setAttribute("type", "hidden");
                        ensweap.setAttribute("name", "ensweap");
                        ensweap.setAttribute("value", document.getElementById('ensweapsel').value);
                        form.appendChild(ensweap);
                    }
                    else {
                        var ensspec = document.createElement("input");
                        ensspec.setAttribute("type", "hidden");
                        ensspec.setAttribute("name", "ensspec");
                        ensspec.setAttribute("value", document.getElementById('ensskillsel').value);
                        form.appendChild(ensspec);
                        var enfight = document.createElement("input");
                        enfight.setAttribute("type", "hidden");
                        enfight.setAttribute("name", "ensfight");
                        enfight.setAttribute("value", {{ apprentice['Ensign']['Fight'] }});
                        form.appendChild(enfight);
                        var enshoot = document.createElement("input");
                        enshoot.setAttribute("type", "hidden");
                        enshoot.setAttribute("name", "ensshoot");
                        enshoot.setAttribute("value", {{ apprentice['Ensign']['Shoot'] }});
                        form.appendChild(enshoot);
                        var enmorale = document.createElement("input");
                        enmorale.setAttribute("type", "hidden");
                        enmorale.setAttribute("name", "ensmorale");
                        enmorale.setAttribute("value", {{ apprentice['Ensign']['Morale'] }});
                        form.appendChild(enmorale);
                        var enhealth = document.createElement("input");
                        enhealth.setAttribute("type", "hidden");
                        enhealth.setAttribute("name", "enshealth");
                        enhealth.setAttribute("value", {{ apprentice['Ensign']['Health'] }});
                        form.appendChild(enhealth);
                        var enexperience = document.createElement("input");
                        enexperience.setAttribute("type", "hidden");
                        enexperience.setAttribute("name", "ensexperience");
                        enexperience.setAttribute("value", {{ apprentice['Ensign']['Experience'] }});
                        form.appendChild(enexperience);
                        var ensskills = "Empty";
                        var ensskillarr = document.getElementsByName("skillchoiceens");
                        for (k = 0; k < ensskillarr.length; k++) {
                            if (ensskillarr[k].checked) {
                                ensskills = ensskillarr[k].value;
                            }
                        }
                        var ensskill = document.createElement("input");
                        ensskill.setAttribute("type", "hidden");
                        ensskill.setAttribute("name", "ensskill");
                        ensskill.setAttribute("value", ensskills);
                        form.appendChild(ensskill);
                        var ensweap = document.createElement("input");
                        ensweap.setAttribute("type", "hidden");
                        ensweap.setAttribute("name", "ensweap");
                        ensweap.setAttribute("value", document.getElementById('hireensweapsel').value);
                        form.appendChild(ensweap);
                    }
                }

                var troopsarr = [];
                for (i = 1; i < 10; i++) {
                    var selector = document.getElementById('troop' + i);
                    if (selector)
                        troopsarr.push(selector.value);
                }
                var troops = document.createElement("input");
                troops.setAttribute("type", "hidden");
                troops.setAttribute("name", "troops");
                troops.setAttribute("value", JSON.stringify(troopsarr));
                form.appendChild(troops);

                document.body.appendChild(form);
                form.submit();
            } else {
                alert("Please check your information!")
            }
        }
    </script>
</head>
<body>
<ul>
    <li><a href="/edit">Home</a></li>
    <li><a href="/new">Create band</a></li>
    <li><a href="/view">View public band</a></li>
    <li><a href="/logout">Logout</a></li>
</ul>
<div id="dist">

    <br/>
    <h1>Warband</h1>
    <h4>Warband Name:<input type="text" id="bandnametext" name="bandnametext" value="{{ band['Name'] }}"
                            onblur="check_Bandname(this.value)"><i id='check_name'>No change</i></h4>
    <h4>isPublic: <select id="isPublic" name="isPublic">
        <option value="public" {% if band['isPublic'] == "public" %} selected {% endif %}>Public</option>
        <option value="private" {% if band['isPublic'] == "private" %} selected {% endif %}>Private</option>
    </select></h4>
    <table border="0">
        <tr>
            <td><h4>Currency remaining: </h4></td>
            <td id='remainingGold'>{{ band['Treasury'] }}</td>
            <td><i id="checkcurrency">Regular Currency</i></td>
        </tr>
        <tr>
            <td>Add Currency:</td>
            <td><input id="topup_num" type="number" value="0"></td>
            <td><input id="topup" type="button" value="Top up" onclick="topUp()"/></td>
        </tr>
        <tr>
            <td><h4>Squad members: </h4></td>
            <td id='members'>{{ band['mbNumber'] }}</td>
            <td><i id='checkmembers'>Regular Members</i></td>
        </tr>
    </table>
    <br/>
    <table id="wizardTable">
        <tr><b>Captain</b></tr>
        <tr>
            <td>Move</td>
            <td>Fight</td>
            <td>Shoot</td>
            <td>Shield</td>
            <td>Morale</td>
            <td>Health</td>
            <td>Specialism</td>
            <td>Weapons and Equipment</td>
            <td>Skills</td>
            <td>Experience</td>
            <td>Add Exp</td>
        </tr>
        <tr>
            <td>{{ band['Captain']['Move'] }}</td>
            <td><input id="capfig" type="number" value="{{ band['Captain']['Fight'] }}"
                       onchange="editCap(this.id, {{ band['Captain']['Fight'] }})"></td>
            <td><input id="capsho" type="number" value="{{ band['Captain']['Shoot'] }}"
                       onchange="editCap(this.id, {{ band['Captain']['Shoot'] }}) "></td>
            <td>{{ band['Captain']['Shield'] }}</td>
            <td><input id="capmor" type="number" value="{{ band['Captain']['Morale'] }}"
                       onchange="editCap(this.id, {{ band['Captain']['Morale'] }})"></td>
            <td><input id="caphea" type="number" value="{{ band['Captain']['Health'] }}"
                       onchange="editCap(this.id, {{ band['Captain']['Health'] }})"></td>
            <td>{{ band['Captain']['Specialism'] }}</td>
            <td>
                <select id="capweapsel1" onchange="updateCapWeapCost(this)">
                    <option value="Empty">Select...</option>
                    {% for weap in weaps %}
                        {% if weap in band['Captain']['Items'][0] %}
                            <option value="{{ weap }}" selected>{{ weap }}</option>
                        {% else %}
                            <option value="{{ weap }}">{{ weap }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
                <select id="capweapsel2" onchange="updateCapWeapCost(this)">
                    <option value="Empty">Select...</option>
                    {% for weap in weaps %}
                        {% if weap in band['Captain']['Items'][1] %}
                            <option value="{{ weap }}" selected>{{ weap }}</option>
                        {% else %}
                            <option value="{{ weap }}">{{ weap }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </td>
            <td>
                {% for opt in skills[band['Captain']['Specialism']] %}
                    {% if opt in band['Captain']['Skillset'] %}
                        <input type="checkbox" name="capskil" value="{{ opt }}" checked disabled>{{ opt }}
                    {% else %}
                        <input type="checkbox" name="capskil" value="{{ opt }}"
                               onclick="editCap('capskil', '{{ opt }}')">
                        {{ opt }}
                    {% endif %}
                {% endfor %}
            </td>
            <td id="capexp">{{ band['Captain']['Experience'] }}</td>
            <td><input id="capexp_num" type="number" value="0"/><input type="button" name="addcapexp" value="Add"
                                                                       onClick="addCapExp()"></td>
        </tr>

    </table>
    <br/>
    <b>Hire apprentice? </b><input type="checkbox" name="appHire" onClick="hireEng()" {% if 'Ensign' in band.keys() %}
                                   checked {% endif %}>250gc<br>
    {% if 'Ensign' in band.keys() %}
        <div id="ensignDiv" style='display: block'>
            <table id="ensignTable">
                <tr><b>Apprentice</b></tr>
                <tr>
                    <td>Move</td>
                    <td>Fight</td>
                    <td>Shoot</td>
                    <td>Shield</td>
                    <td>Morale</td>
                    <td>Health</td>
                    <td>Specialism</td>
                    <td>Weapons and Equipment</td>
                    <td>Skills</td>
                    <td>Experience</td>
                    <td>Add Exp</td>
                </tr>
                <tr>
                    <td>{{ band['Ensign']['Move'] }}</td>
                    <td><input id="enfig" type="number" value="{{ band['Ensign']['Fight'] }}"
                               onchange="editEns(this.id, {{ band['Ensign']['Fight'] }})"></td>
                    <td><input id="ensho" type="number" value="{{ band['Ensign']['Shoot'] }}"
                               onchange="editEns(this.id, {{ band['Ensign']['Shoot'] }})"></td>
                    <td>{{ band['Ensign']['Shield'] }}</td>
                    <td><input id="enmor" type="number" value="{{ band['Ensign']['Morale'] }}"
                               onchange="editEns(this.id, {{ band['Ensign']['Morale'] }})"></td>
                    <td><input id="enhea" type="number" value="{{ band['Ensign']['Health'] }}"
                               onchange="editEns(this.id, {{ band['Ensign']['Health'] }})"></td>
                    <td>{{ band['Ensign']['Specialism'] }}</td>
                    <td>
                        <select id="ensweapsel" onchange="updateEngWeapCost(this)">
                            <option value="Empty">Select...</option>
                            {% for weap in weaps %}
                                {% if weap in band['Ensign']['Items'] %}
                                    <option value="{{ weap }}" selected>{{ weap }}</option>
                                {% else %}
                                    <option value="{{ weap }}">{{ weap }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    </td>
                    <td>
                        {% for opt in skills[band['Ensign']['Specialism']] %}
                            {% if opt in band['Ensign']['Skillset'] %}
                                <input type="checkbox" name="ensskil" value="{{ opt }}" checked disabled>{{ opt }}
                            {% else %}
                                <input type="checkbox" name="ensskil" value="{{ opt }}"
                                       onclick="editEns('ensskil', '{{ opt }}')">{{ opt }}
                            {% endif %}
                        {% endfor %}
                    </td>
                    <td id="enexp">{{ band['Ensign']['Experience'] }}</td>
                    <td><input id="enexp_num" type="number" value="0"/><input type="button" name="addenexp" value="Add"
                                                                              onClick="addEnsExp()"></td>
                </tr>
            </table>
        </div>
    {% endif %}

    <div id="ensignHireDiv" style='display: none'>
        <table id="ensignHireTable">
            <tr><b>Apprentice</b></tr>
            <tr>
                <td>Move</td>
                <td>Fight</td>
                <td>Shoot</td>
                <td>Shield</td>
                <td>Morale</td>
                <td>Health</td>
                <td>Specialism</td>
                <td>Weapons and Equipment</td>
                <td>Skills</td>
                <td>Experience</td>
            </tr>
            <tr>
                <td>{{ apprentice['Ensign']['Move'] }}</td>
                <td>{{ apprentice['Ensign']['Fight'] }}</td>
                <td>{{ apprentice['Ensign']['Shoot'] }}</td>
                <td>{{ apprentice['Ensign']['Shield'] }}</td>
                <td>{{ apprentice['Ensign']['Morale'] }}</td>
                <td>{{ apprentice['Ensign']['Health'] }}</td>
                <td>
                    <select id="ensskillsel" onchange="setEnsSkillchoice(this)">
                        <option value="Empty">Select...</option>
                        {% for spec in specs %}
                            <option value="{{ spec }}">{{ spec }}</option>
                        {% endfor %}
                    </select>
                </td>
                <td>
                    <select id="hireensweapsel" onchange="updateEngWeapCost(this)">
                        <option value="Empty">Select...</option>
                        {% for weap in weaps %}
                            <option value="{{ weap }}">{{ weap }}</option>
                        {% endfor %}
                    </select>
                </td>
                <td></td>
                <td>{{ apprentice['Ensign']['Experience'] }}</td>
            </tr>
        </table>
    </div>

    <br/>
    <table id='rosterTable'>
        <tr><b>Squad memebers</b></tr>
        <tr>
            <td>Class</td>
            <td>Move</td>
            <td>Fight</td>
            <td>Shoot</td>
            <td>Shield</td>
            <td>Morale</td>
            <td>Health</td>
            <td>Cost</td>
            <td>Notes</td>
        </tr>

        {% for trooper in band['Troops'] %}
            <tr>
                <td>
                    <select id="troop{{ loop.index }}" onchange="updateTableRow({{ loop.index }}, this)">
                        <option value="Empty">Empty</option>
                        {% for troop in people.keys() %}
                            {% if troop == trooper %}
                                <option value="{{ troop }}" selected>{{ troop }}</option>
                            {% else %}
                                <option value="{{ troop }}">{{ troop }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </td>
                <td>{{ people[trooper]['Move'] }}</td>
                <td>{{ people[trooper]['Fight'] }}</td>
                <td>{{ people[trooper]['Shoot'] }}</td>
                <td>{{ people[trooper]['Shield'] }}</td>
                <td>{{ people[trooper]['Morale'] }}</td>
                <td>{{ people[trooper]['Health'] }}</td>
                <td>{{ people[trooper]['Cost'] }}</td>
                <td>{{ people[trooper]['Notes'] }}</td>
            </tr>
        {% endfor %}
        {% for i in range((band['Troops']|length)+1,10) %}
            <tr>
                <td>
                    <select id="troop{{ i }}" onchange="updateTableRow({{ i }}, this)">
                        <option value="Empty">Empty</option>
                        {% for troop in people.keys() %}
                            <option value="{{ troop }}">{{ troop }}</option>
                        {% endfor %}
                    </select>
                </td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>0</td>
                <td>-</td>
            </tr>
        {% endfor %}
    </table>
    <br/>
    <input id="editor" type="button" value="Edit Warband" onclick="doFormSubmit();"/>
    &nbsp;
    <input id="clear" type="button" value="Reset" onclick="window.location.href='/edit/{{ band['Name'] }}'"/>
    &nbsp;
    <input id="back" type="button" value="Back" onclick="window.location.href='/edit'"/>
    <br/><br/>
</div>
</body>
</html>

